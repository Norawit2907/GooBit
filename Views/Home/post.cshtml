
@{
    ViewData["Title"] = "Post";
}

<link rel="stylesheet" href="~/css/postpage.css"/>
<script src="~/js/Home/EventPost.js"></script>
<script src="~/js/Home/EventMap.js" defer></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBuU9Wcj-4Z3ikPd9dp75Z8Hxdu3WII9Wc&libraries=places"></script>

<div class="post-page">
    <div class="post-banner">
        <div id="bannermap"></div>
    </div>

    <!-- <div class="post-header">
        <h1>@ViewBag.EventDisplay.title</h1>

        <img src="~/uploadFiles/UserProfile/@ViewBag.EventDisplay.user_image"/>
        <a class="back" asp-area="" asp-controller="Home" asp-action="Index">
            <img  src="~/Icon/Union.png"/>
        </a>
    </div> -->
    <div class="post-container">

        <div class="post-body">
            <div class="split-left">
                <div class="post-info">
                    <img id="profile-image" src="~/uploadFiles/UserProfile/@ViewBag.EventDisplay.user_image"/>
                    <p id="author">by @ViewBag.EventDisplay.firstname @ViewBag.EventDisplay.lastname</p>
                    <p id="category">Category • @ViewBag.EventDisplay.category</p>
                    <p id="location">Location • @ViewBag.EventDisplay.googlemap_location</p>
                    <p id="description">@ViewBag.EventDisplay.description</p>
                    @foreach(var img in ViewBag.EventDisplay.event_img)
                    {
                        <img src="~/uploadFiles/EventImage/@img"/>
                    }
                    <div id="pagemap"></div>
                    <div class="join-bt">
                        <button class="join-bt">I want to anticipate in this event </button>
                </div>
            </div>
            </div>
            <div class="split-right">
                <div class="post-status">
                    <div class="end-date">
                        <div>
                            <p>End in</p>
                            <p id="date">@ViewBag.EventDisplay.end_date.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</p>
                            
                        </div>
                        <img src="~/Icon/Union.png"/>
                    </div>
                    <div class="joined">
                        <div>
                            <p>joined</p>
                            <p id="parti"> @ViewBag.EventDisplay.total_member/@ViewBag.EventDisplay.max_member </p>
                        </div>
                        <img src="~/Icon/Vector.png"/>
                    </div>
                </div>

                <div class="post-middle">
                    <div class="comment-section">
                        <div class="create-comment">
                            <img id="create-comment-image" src="~/uploadFiles/UserProfile/@ViewBag.EventDisplay.user_image"/>
                            <input id="create-comment-text"type="text" placeholder="Add comment">
                            <button id="create-icon" type="submit" onclick="CreateComment('@ViewBag.user_id', '@ViewBag.EventDisplay.user_image', '@ViewBag.EventDisplay.firstname', '@ViewBag.EventDisplay.lastname', '@ViewBag.EventDisplay.Id')">
                                <img src="~/Icon/Icon.png"/>
                            </button>
                        </div>
                    </div>
                    <div class="comment-container">
                        <p id="comment_num">@ViewBag.EventDisplay.comments.Count comments</p>
                        
                        <div class="list-comment">
                            @foreach(var _comment in ViewBag.EventDisplay.comments){
                                <div class="comment">
                                    <div class="comment-header">
                                        <img  id="header-comment-image" src="~/uploadFiles/UserProfile/@_comment.user_image"/>
                                        <div class="header-text">
                                            <p id="uname">@_comment.firstname @_comment.lastname</p>
                                            <p id="date">@_comment.create_time</p>
                                        </div>
                                        <button>
                                            <img id="del" src="~/Icon/delete.png"/>
                                        </button>
                                    </div>
                                    <div class="comment-body">
                                        <p>@_comment.text</p>
                                        @foreach(var _reply in _comment.replies){
                                            <div class="reply-body">
                                                <img src="~/uploadFiles/UserProfile/@_reply.user_image">
                                                <div id="reply-text">
                                                    <p id="name">@_reply.firstname @_reply.lastname</p>
                                                    <p id="text">@_reply.text</p>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                    <div class="create-reply-container">
                                        <img  id="reply-image" src="~/uploadFiles/UserProfile/@ViewBag.EventDisplay.user_image"/>
                                        <input id="@_comment.Id" type="text" placeholder="Add comment">
                                        <button id="reply-button" type="submit" onclick="CreateReply('@_comment.Id', '@ViewBag.user_id', '@ViewBag.EventDisplay.user_image', '@_comment.firstname', '@_comment.lastname')">
                                            <img src="~/Icon/Icon.png"/>
                                        </button>
                                    </div>
                                </div>
                            }
                        </div>
                </div>

                
            </div>
        </div> 
    </div>
</div>